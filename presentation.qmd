---
title: "Final Project Presentation"
subtitle: "INFO 526 - Summer 2024 - Final Project"
author: "DataDuo"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

if (!require("pacman")) {
  install.packages("pacman")
}
# use this line for installing/loading
#pacman::p_load() 
pacman::p_load(tidyverse,
               lubridate,
               colorspace,
               broom,
               fs,
               janitor,
               ggridges,
               dsbox, 
               scales,
               here, 
               vroom,
               palmerpenguins,
               ggthemes,
               extrafont, 
               tidytuesdayR, 
               stringdist, 
               maps, 
               tigris,
               patchwork,
               sf)
```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false

polling_places <- readr::read_csv(here("data", "updated_polling_places2.csv"))


```

## Introduction

The accessibility of polling places is a critical factor in ensuring that all eligible voters can participate in the democratic process. The availability and distribution of polling places can significantly impact voter turnout and influence the overall effectiveness of an election. This project aims to analyze the trends in polling place availability across the United States from 2012 to 2020, with a specific focus on temporal changes and geographic disparities. By examining national and state-level data, as well as differences between urban and rural areas, this project seeks to understand the factors influencing polling place changes and their impact on voter accessibility. Through this analysis, we hope to provide insights that can inform policies to enhance voter access and participation in future elections.


## Data Sources

-   The polling places data used in this presentation originates from " The Center for Public Integrity".

-   The dataset was featured in their September 2020 article titled "National data release sheds light on past polling place changes".

## Data Cleaning and Preparation

-   The dataset was grouped using the "name" column. We created a looping function that uses the stringdist[^1] function to calculate how similar the surrounding 25 observation (by index) were.
-   Grouped observations if they were 90% or more similar to each other.
-   Results in true number of polling locations because some locations host multiple precincts.

[^1]: Stringdist citation

# Question 1

## Jeevana Plot

```{r}
polling_places_trends <- polling_places %>%
  group_by(election_date, state) %>%
  count(group) %>%
  summarise(number_of_polling_places =n())


ggplot(polling_places_trends, aes(x=election_date, y=number_of_polling_places, color=state)) +
  geom_line() +
  geom_point() +
  facet_wrap(~state) +
  ggtitle("Number of Polling Places Over Time (By State)") +
  scale_x_date(date_labels = "%y")+
  xlab("Year") +
  ylab("Number of Polling Places")+
  theme(
    legend.position = "none"
  )
```

## Luis' Plot


```{r, warning=FALSE, fig.width=5.5}

polling_places_state2 <- polling_places |>
  mutate(election_date = ymd(election_date)) |>
  filter(month(election_date) == 11, year(election_date) %in% c("2012","2016","2020"), !(name %in% c("unknown", "Do not use", "No Voters"))) |>
  mutate(state = fct_relevel(state)) |>
  group_by(election_date, state) |>
  count(group) |>
  summarize(n = n())


# graph by state 
polling_places_state2  |>
  mutate(state = fct_rev(state)) |>
  mutate(state = fct_reorder(state, n)) |>
  ggplot(aes(state, n)) +
  geom_point()+
  facet_wrap(vars(election_date), nrow = 3)
```

# Q2 

## Jeevana's Plot

```{r}

original_dataset <- read_csv(here("data", "original_dataset.csv"))


original_dataset <- original_dataset %>%
  mutate(year = year(election_date))

#calculating polling places
polling_places_summary <- original_dataset %>%
  group_by(state, year) %>%
  summarise(number_of_polling_places = n_distinct(precinct_name))


original_dataset <- merge(original_dataset, polling_places_summary, by = c("state", "year"))

na_indices <- which(is.na(original_dataset$jurisdiction_type))


original_dataset$jurisdiction_type <- trimws(original_dataset$jurisdiction_type)


patterns <- c("Calumet | Town of Harrison", "Marinette | Village of Wausaukee", 
              "Outagamie | City of Seymour", "Taylor | Town of Medford", 
              "Adams | Town Of Adams", "Dodge | Village of Lomira", 
              "Dunn | Town of Tainter", "Eau Claire | Town of Bridge Creek", 
              "Eau Claire | City of Augusta", "Eau Claire | City of Altoona", 
              "Iowa | Town of Brigham", "Lafayette | City of Darlington", 
              "Oneida | Town of Hazelhurst", "Washburn | City of Shell Lake", 
              "Adams | CITY OF ADAMS")

replacements <- c("town", "village", "city", "town", "town", "village", 
                  "town", "town", "city", "city", "town", "city", "town", 
                  "city", "city")

for (i in seq_along(patterns)) {
  original_dataset$jurisdiction_type[grepl(patterns[i], original_dataset$jurisdiction)] <- replacements[i]
}




original_dataset$area_type <- ifelse(original_dataset$jurisdiction_type %in% c("borough", "city", "municipality"),
                                     "urban",
                                     ifelse(original_dataset$jurisdiction_type %in% c("county", "town", "parish", "county_municipality", "village"),
                                            "rural", 
                                            NA ))




original_dataset$voter_turnout_rate <- rep(65, nrow(original_dataset))
original_dataset$voter_turnout_count <- round(original_dataset$number_of_polling_places * 0.65)




polling_places_area_type <- original_dataset %>%
  group_by(area_type, state, year) %>%
  summarise(number_of_polling_places = n_distinct(precinct_name))


ggplot(polling_places_area_type, aes(x=area_type, y=number_of_polling_places, fill=area_type)) +
  geom_bar(stat="identity", position="dodge") +
  facet_wrap(~year) +
  ggtitle("Distribution of Polling Places (Urban vs Rural)") +
  xlab("Area Type") +
  ylab("Number of Polling Places")


```


## Luis' Plot




